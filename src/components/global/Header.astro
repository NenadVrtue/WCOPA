---
import ButtonLink from "../ui/ButtonLink.astro";
import Container from "./Container.astro";
import { Image } from "astro:assets";
import logo from "@assets/logo.png";
import Navigation from "./Navigation.jsx";
import { settingsQuery } from "@/sanity/lib/queries";
import { loadQuery } from "@/sanity/lib/load-query";
import { type SanityDocument } from "@sanity/client";

const { data: settings } = await loadQuery<SanityDocument>({
  query: settingsQuery,
});

const buttonLinkContact = {
  linkText: "Contact",
  linkType: "external",
  internalLink: "/contact-us",
  url: "/contact-us",
  blank: false,
  hide: false,
};

const {
  mainHowToEnter,
  mainCompetitions,
  mainScheduleOfEvents,
  mainVenues,
  mainTestimonials,
  mainComunitySupport,
  mainMedia,
  mainPrizes,
  mainAbout,
} = settings;
---

<header
  id="header"
  class="py-1.5 sticky top-0 z-50 bg-white/50 transition-all duration-100"
>
  <Container classes="flex justify-between items-center">
    <a href="/"> <Image src={logo} alt="Logo" class="h-20 w-auto" /></a>

    <!-- <a href="/example">Example</a>
      <a href="/example2">Example 2</a>
      <a href="/qa">QA</a>
      <a href="/qa-2">QA 2</a>
      <a href="/qa-3">QA 3</a> -->
    <div class="flex items-center justify-end">
      <div class="hidden lg:block">
        <Navigation
          howToEnter={mainHowToEnter}
          competitions={mainCompetitions}
          scheduleOfEvents={mainScheduleOfEvents}
          venues={mainVenues}
          testimonials={mainTestimonials}
          comunitySupport={mainComunitySupport}
          media={mainMedia}
          prizes={mainPrizes}
          about={mainAbout}
          client:load
        />
      </div>

      <ButtonLink buttonLink={buttonLinkContact} variation="nav" />
    </div>
    <div class="lg:hidden flex items-center justify-center">
      <div id="open-menu">hamburger</div>
      <div
        id="mobile-menu"
        class="fixed w-screen top-0 translate-x-[-100%] right-0 h-screen bg-white z-100"
      >
        <div id="close-menu">Close</div>
      </div>
    </div>
  </Container>
</header>

<style>
  .scrolled {
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Example: add shadow */
    backdrop-filter: blur(12px);
  }
</style>

<script>
  const openMenu = document.getElementById("open-menu");
  const closeMenu = document.getElementById("close-menu");
  const mobileMenu = document.getElementById("mobile-menu");
  openMenu.addEventListener("click", () => {
    mobileMenu.classList.remove("translate-x-[-100%]");
  });

  closeMenu.addEventListener("click", () => {
    mobileMenu.classList.add("translate-x-[-100%]");
  });

  document.addEventListener("DOMContentLoaded", () => {
    const header = document.getElementById("header");
    window.addEventListener("scroll", () => {
      if (window.scrollY > 50) {
        // Adjust the scroll position as needed
        header.classList.add("scrolled");
      } else {
        header.classList.remove("scrolled");
      }
    });
  });
</script>
